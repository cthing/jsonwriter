# ![C Thing Software](https://www.cthing.com/branding/CThingSoftware-57x60.png "C Thing Software") jsonwriter

This library writes JSON with or without pretty printing. The library has no runtime dependencies on any JSON processing
package.

## Usage
The library is available from [Maven Central](https://repo.maven.apache.org/maven2/org/cthing/jsonwriter/) using the following Maven dependency:
```xml
<dependency>
  <groupId>org.cthing</groupId>
  <artifactId>jsonwriter</artifactId>
  <version>1.0.0</version>
</dependency>
```
or the following Gradle dependency:
```kotlin
implementation("org.cthing:jsonwriter:1.0.0")
```

### Getting Started
To begin writing JSON, create an instance of a `JsonWriter`. The instance is not thread safe. Naming of the methods
follows that used in
[IETF RFC-8259: The JavaScript Object Notation (JSON) Data Interchange Format](https://datatracker.ietf.org/doc/html/rfc8259).

### Writing an Object
The following are examples of writing a JSON object. Note the use of the fluent API.

Simple object with two ways to create a member:
```java
final JsonWriter writer = new JsonWriter();
writer.setPrettyPrint(true);
writer.startObject()
      .member("foo", "bar")
      .member("joe", 12)
      .member("abc")
      .value(true)
      .endObject();
```
JSON written:
```json
{
    "foo": "bar",
    "joe": 12,
    "abc": true
}
```

Two ways to create nested objects:
```java
final JsonWriter writer = new JsonWriter();
writer.setPrettyPrint(true);
writer.startObject()
      .member("abc")
      .startObject()
      .member("def", "hello")
      .endObject()
      .memberStartObject("xyz")
      .member("hij", 23)
      .endObject()
      .endObject();
```
JSON written:
```json
{
    "abc": {
        "def": "hello"
    },
    "xyz": {
        "hij": 23
    }
}
```

### Writing an Array
The following are examples of writing a JSON array.

Simple array:
```java
final JsonWriter writer = new JsonWriter();
writer.setPrettyPrint(true);
writer.startArray()
      .value("bar")
      .value(12)
      .value(true)
      .endArray();
```
JSON written:
```json
[
    "bar",
    12,
    true
]
```

Array with nested array and object:
```java
final JsonWriter writer = new JsonWriter();
writer.setPrettyPrint(true);
writer.startArray()
      .startObject()
      .member("def", "hello")
      .endObject()
      .startArray()
      .value(23)
      .endArray()
      .endArray();
```
JSON written:
```json
[
    {
        "def": "hello"
    },
    [
        23
    ]
]
```

### Detailed Usage
See the [Javadoc in the JsonWriter](https://javadoc.io/doc/org.cthing/jsonwriter/latest/org/cthing/jsonwriter/JsonWriter.html) class for detailed
usage and configuration information.

## Building
The library is compiled for Java 17. If a Java 17 toolchain is not available, one will be downloaded.

Gradle is used to build the library:
```bash
./gradlew build
```
The Javadoc for the library can be generated by running:
```bash
./gradlew javadoc
```

## Releasing
This project is released on the [Maven Central repository](https://central.sonatype.com/artifact/org.cthing/jsonwriter).
Perform the following steps to create a release.

- Commit all changes for the release
- In the `build.gradle.kts` file
    - Ensure that `baseVersion` is set to the version for the release. The project follows [semantic versioning](https://semver.org/).
    - Set `isSnapshot` to `false`
- Commit the changes
- Wait until CI builds the release candidate
- Run the command `mkrelease jsonwriter <version>`
- In a browser go to the [Maven Central Repository Manager](https://s01.oss.sonatype.org/)
- Log in
- Use the `Staging Upload` to upload the generated artifact bundle `jsonwriter-bundle-<version>.jar`
- Click on `Staging Repositories`
- Once it is enabled, press `Release` to release the artifacts to Maven Central
- Log out
- Wait for the new release to be available on Maven Central
- In a browser, go to the project on GitHub
- Generate a release with the tag `<version>`
- In the build.gradle.kts file
    - Increment the `baseVersion` patch number
    - Set `isSnapshot` to `true`
- Update the `CHANGELOG.md` with the changes in the release and prepare for next release changes
- Update the `Usage` section in the `README.md` with the latest artifact release version
- Commit these changes
